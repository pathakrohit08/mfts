name: test
on:
  push:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: checkout
        uses: actions/checkout@v2
        with:
          fetch-depth: 2  # OR "2" -> To retrieve the preceding commit.

      - name: List all added files
        run: |
          for file in ${{ steps.checkout.outputs.added_files }}; do
            echo "$file was added"
          done

      - name: List all changed files
        run: |
          echo "${{ steps.checkout.outputs.modified_files }}"
          for file in ${{ steps.checkout.outputs.modified_files }}; do
            echo "$file was modified"
          done

      - name: Run step when a file changes
        if: contains(steps.checkout.outputs.modified_files, 'my-file.txt')
        run: |
          echo "Your my-file.txt file has been modified."

      - name: Run step when a file has been deleted
        if: contains(steps.checkout.outputs.deleted_files, 'test.txt')
        run: |
          echo "Your test.txt file has been deleted."

      - name: Get specific changed files
        id: checkout-specific
        uses: actions/checkout@v2
        with:
          files: |
            my-file.txt
            test.txt
            new.txt
            test_directory
            *.sh
            *.png
            !*.md
            *.jpeg
            *.py
            **/migrate-*.sql
          files_ignore: |
            *.yml

      - name: Run step if any of the listed files above change
        if: steps.checkout-specific.outputs.any_changed == 'true'
        run: |
          echo "One or more files listed above has changed."

      - name: Run step if only the files listed above change
        if: steps.checkout-specific.outputs.only_changed == 'true'
        run: |
          echo "Only files listed above have changed."

      - name: Run step if any of the listed files above is deleted
        if: steps.checkout.outputs.any_deleted == 'true'
        run: |
          for file in ${{ steps.checkout.outputs.deleted_files }}; do
            echo "$file was deleted"
          done

      - name: Run step if all listed files above have been deleted
        if: steps.checkout.outputs.only_deleted == 'true'
        run: |
          for file in ${{ steps.checkout.outputs.deleted_files }}; do
            echo "$file was deleted"
          done

      - name: Use a source file or list of file(s) to populate to files input.
        id: checkout-specific-source-file
        uses: actions/checkout@v2
        with:
          files_from_source_file: |
            test/checkout-list.txt

      - name: Use a source file or list of file(s) to populate to files input and optionally specify more files.
        id: checkout-specific-source-file-and-specify-files
        uses: actions/checkout@v2
        with:
          files_from_source_file: |
            test/checkout-list.txt
          files: |
            test.txt

      - name: Use a different commit SHA
        id: checkout-custom-sha
        uses: actions/checkout@v2
        with:
          sha: ${{ github.event.pull_request.head.sha }}

      - name: Use a different base SHA
        id: checkout-custom-base-sha
        uses: actions/checkout@v2
        with:
          base_sha: "2096ed0"
          
      - name: Checkout into dir1
        uses: actions/checkout@v2
        with:
          fetch-depth: 0
          path: dir1

      - name: Run checkout with defaults on the dir1
        id: checkout-for-dir1
        uses: actions/checkout@v2
        with:
          path: dir1

      - name: List all added files in dir1
        run: |
          for file in ${{ steps.checkout-for-dir1.outputs.added_files }}; do
            echo "$file was added"
          done

      - name: Run checkout using the last commit on the remote branch
        id: checkout-since-last-remote-commit
        uses: actions/checkout@v2
        with:
          since_last_remote_commit: "true"
      
      - name: Run checkout using the fork point of a pull request
        id: checkout-fork-point
        uses: actions/checkout@v2
        with:
          use_fork_point: "true"

          
     
